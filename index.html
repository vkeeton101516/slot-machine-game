<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devoted Deals Slots</title>
    <link rel="stylesheet" href="style.css"> <!-- Link to your external CSS file -->
</head>
<body>

    <div class="header">Devoted Deals Slots</div>
    <div class="slot-container">
        <div class="slot-machine">
            <div class="slot"><img id="slot1" src="https://i.postimg.cc/wB88DKyb/video-slot-machine-symbols-cherries-thumbnail-square-0000.jpg" alt="Slot"></div>
            <div class="slot"><img id="slot2" src="https://i.postimg.cc/wB88DKyb/video-slot-machine-symbols-cherries-thumbnail-square-0000.jpg" alt="Slot"></div>
            <div class="slot"><img id="slot3" src="https://i.postimg.cc/wB88DKyb/video-slot-machine-symbols-cherries-thumbnail-square-0000.jpg" alt="Slot"></div>
        </div>
        <button class="spin-button" onclick="spin()">Spin</button>
        <div class="result" id="result"></div>
        <div class="confirmation-number" id="confirmationNumber"></div>
        <div class="warning" id="warning"></div>
    </div>

    <script>
        const slotImages = [
            "https://i.postimg.cc/wB88DKyb/video-slot-machine-symbols-cherries-thumbnail-square-0000.jpg", // Cherry
            "https://i.postimg.cc/yxXXpZvZ/depositphotos-159290092-stock-illustration-slot-machine-seven-icon-color.webp", // Seven
            "https://i.postimg.cc/cHDFMj4n/istockphoto-1135769825-612x612.jpg" // Bar
        ];

        const confirmationNumbers = [
            "45875664", "58761232", "87653099", "14589736", "01589536", 
            "25796864", "28658901", "02040587", "32158964", "38561515",
            "71456611", "82547125", "94585477", "05161983", "02262007",
            "09232009", "04586652", "17565211", "25893455", "24751855"
        ];

        let spinCount = parseInt(localStorage.getItem("spinCount")) || 0;
        const maxSpins = 5;
        let monthlyWinners = parseInt(localStorage.getItem("monthlyWinners")) || 0;
        const maxWinners = 20;
        let winnerIndices = JSON.parse(localStorage.getItem("winnerIndices")) || [];

        // Preload images
        function preloadImages() {
            slotImages.forEach(src => {
                const img = new Image();
                img.src = src;
            });
        }

        preloadImages();

        function getRandomImage() {
            return slotImages[Math.floor(Math.random() * slotImages.length)];
        }

        function getRandomConfirmationNumber() {
            let availableNumbers = confirmationNumbers.filter((_, index) => !winnerIndices.includes(index));
            if (availableNumbers.length === 0) return null; // No available numbers left
            let randomIndex = Math.floor(Math.random() * availableNumbers.length);
            let confirmationNumber = availableNumbers[randomIndex];
            winnerIndices.push(confirmationNumbers.indexOf(confirmationNumber));
            localStorage.setItem("winnerIndices", JSON.stringify(winnerIndices));
            return confirmationNumber;
        }

        function spin() {
            if (spinCount >= maxSpins) {
                document.getElementById('warning').textContent = "You have reached the daily spin limit!";
                return;
            }

            if (monthlyWinners >= maxWinners) {
                document.getElementById('warning').textContent = "The monthly winner limit has been reached.";
                return;
            }

            let slot1 = document.getElementById('slot1');
            let slot2 = document.getElementById('slot2');
            let slot3 = document.getElementById('slot3');

            // Reset animation
            slot1.style.animation = 'none';
            slot2.style.animation = 'none';
            slot3.style.animation = 'none';

            // Force reflow/repaint to restart the animation
            slot1.offsetHeight; // trigger reflow
            slot2.offsetHeight;
            slot3.offsetHeight;

            // Apply spinning animation again
            slot1.style.animation = 'spinAnimation 2s cubic-bezier(0.25, 0.8, 0.25, 1)';
            slot2.style.animation = 'spinAnimation 2s cubic-bezier(0.25, 0.8, 0.25, 1)';
            slot3.style.animation = 'spinAnimation 2s cubic-bezier(0.25, 0.8, 0.25, 1)';

            // Update images
            slot1.src = getRandomImage();
            slot2.src = getRandomImage();
            slot3.src = getRandomImage();

            // Increment spin count
            spinCount++;
            localStorage.setItem("spinCount", spinCount);

            // Check for a winning combination (3 cherries)
            if (slot1.src === slot2.src && slot2.src === slot3.src && slot1.src === slotImages[0]) {
                let confirmationNumber = getRandomConfirmationNumber();
                if (confirmationNumber) {
                    monthlyWinners++;
                    localStorage.setItem("monthlyWinners", monthlyWinners);
                    document.getElementById('result').textContent = "You win!";
                    document.getElementById('confirmationNumber').textContent = "Confirmation Number: " + confirmationNumber;
                }
            } else {
                document.getElementById('result').textContent = "Try Again!";
                document.getElementById('confirmationNumber').textContent = "";
            }
        }
    </script>
</body>
</html>
