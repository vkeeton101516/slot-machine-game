<script>
    const slotImages = [
        "https://iili.io/2yd7WoG.jpg", // Cherry
        "https://iili.io/2ydaqYB.webp" // Non-winning symbol
    ];

    // Your list of confirmation numbers
    const confirmationNumbers = [
        45875664, 58761232, 87653099, 14589736, 01589536, 25796864, 28658901, 02040587,
        32158964, 38561515, 71456611, 82547125, 94585477, 05161983, 02262007, 09232009,
        04586652, 17565211, 25893455, 24751855
    ];

    let usedConfirmationNumbers = JSON.parse(localStorage.getItem("usedConfirmationNumbers")) || [];
    let dailyWinners = JSON.parse(localStorage.getItem("dailyWinners")) || {}; // Track daily winners by their confirmation number

    let spinCount = parseInt(localStorage.getItem("spinCount")) || 0;
    const maxSpins = 5;
    let monthlyWinners = parseInt(localStorage.getItem("monthlyWinners")) || 0;
    const maxWinners = 20;

    function getRandomImage() {
        return slotImages[Math.floor(Math.random() * slotImages.length)];
    }

    function getConfirmationNumber() {
        if (usedConfirmationNumbers.length >= confirmationNumbers.length) {
            return null; // No more unique numbers available
        }
        let randomIndex = Math.floor(Math.random() * confirmationNumbers.length);
        while (usedConfirmationNumbers.includes(confirmationNumbers[randomIndex])) {
            randomIndex = Math.floor(Math.random() * confirmationNumbers.length); // Find unused number
        }
        let confirmationNumber = confirmationNumbers[randomIndex];
        usedConfirmationNumbers.push(confirmationNumber);
        localStorage.setItem("usedConfirmationNumbers", JSON.stringify(usedConfirmationNumbers)); // Update used numbers
        return confirmationNumber;
    }

    function spin() {
        if (spinCount >= maxSpins) {
            document.getElementById('warning').textContent = "You have reached the daily spin limit!";
            return;
        }

        if (monthlyWinners >= maxWinners) {
            document.getElementById('warning').textContent = "The monthly winner limit has been reached.";
            return;
        }

        let slot1 = document.getElementById('slot1');
        let slot2 = document.getElementById('slot2');
        let slot3 = document.getElementById('slot3');

        let tempImages = [getRandomImage(), getRandomImage(), getRandomImage()];

        // Smooth Spin Effect
        let spinDuration = 2000; // Total spin time
        let intervalDuration = 50; // Time interval for each image change
        let totalIterations = spinDuration / intervalDuration;
        let currentIteration = 0;

        let spinInterval = setInterval(() => {
            slot1.src = getRandomImage();
            slot2.src = getRandomImage();
            slot3.src = getRandomImage();
            currentIteration++;

            if (currentIteration >= totalIterations) {
                clearInterval(spinInterval);
                slot1.src = tempImages[0];
                slot2.src = tempImages[1];
                slot3.src = tempImages[2];
                checkResult(tempImages);
            }
        }, intervalDuration);

        spinCount++;
        localStorage.setItem("spinCount", spinCount);
    }

    function checkResult(images) {
        const today = new Date().toISOString().split('T')[0]; // Get current date in YYYY-MM-DD format

        // Check if the player already won today
        if (dailyWinners[today] && dailyWinners[today].includes(images[0])) {
            document.getElementById('result').innerHTML = "<span style='color: red;'>You've already won today!</span>";
            return;
        }

        if (images[0] === images[1] && images[1] === images[2] && images[0] === "https://iili.io/2yd7WoG.jpg") {
            const confirmationNumber = getConfirmationNumber();
            if (confirmationNumber) {
                document.getElementById('result').innerHTML = `<span style='color: yellow;'>You Win! Confirmation Number: ${confirmationNumber}</span>`;
                monthlyWinners++;
                localStorage.setItem("monthlyWinners", monthlyWinners);

                // Store the daily winner
                if (!dailyWinners[today]) {
                    dailyWinners[today] = [];
                }
                dailyWinners[today].push(images[0]); // Mark this image as a winner for today
                localStorage.setItem("dailyWinners", JSON.stringify(dailyWinners)); // Update daily winners
            } else {
                document.getElementById('result').innerHTML = "<span style='color: yellow;'>You Win! But no more confirmation numbers available this month.</span>";
            }
        } else {
            document.getElementById('result').innerHTML = "<span style='color: red;'>Try Again!</span>";
        }
    }
</script>
